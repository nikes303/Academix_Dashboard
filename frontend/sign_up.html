<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Professor Sign-Up</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.0/dist/minty/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap"
      rel="stylesheet"
    />
    <style>
        /* Your existing CSS is fine, but adding a style for the message box */
        .message-box { display: none; margin-top: 15px; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body, html { height: 100%; margin: 0; padding: 0; }
        header { height: 100px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; background: linear-gradient(to bottom right, #1e054a, #6a2b9e); border-bottom: 1px solid #ddd; position: sticky; top: 0; z-index: 1021;}
.header-logo {
  height: 80px; 
  width: auto;
  position: relative; 
  top: 0; 
  left: 10px;
}
        .content { padding: 20px; }
        .form-container { background: #e9ecef; border-radius: 10px; padding: 20px; max-width: 800px; margin: 20px auto; box-shadow: 0px 4px 6px rgba(21, 0, 0, 0.1); }
        .footer { background: linear-gradient(to bottom right, #1e054a, #6a2b9e); color: white; padding: 10px 20px; text-align: center; width: 100%; }
    </style>
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-light px-3">
        <img src="logo2.png" alt="Academix Logo" class="header-logo" />
    </header>

    <div class="content">
      <form class="form-container" id="signup-form">
        <fieldset>
          <legend>
            <h2 style="font-family: 'Roboto Mono', monospace; font-weight: bold">
              <b>Sign-Up</b>
            </h2>
          </legend>

          <!-- Full Name -->
          <div class="mb-3">
            <label for="profName" class="form-label">Full Name *</label>
            <input type="text" class="form-control" id="profName" placeholder="Enter full name" required />
          </div>

          <!-- Email -->
          <div class="mb-3">
            <label for="profEmail" class="form-label">Email *</label>
            <input type="email" class="form-control" id="profEmail" placeholder="Enter email" required />
          </div>
          
           <!-- Employee ID -->
          <div class="mb-3">
            <label for="employeeID" class="form-label">Employee ID *</label>
            <input type="text" class="form-control" id="employeeID" placeholder="Enter employee ID" required />
          </div>

          <!-- Department -->
          <div class="mb-3">
            <label for="deptSelect" class="form-label">Department *</label>
            <select class="form-select" id="deptSelect" required>
              <option value="" selected disabled>Select a department</option>
              <option value="ISE">ISE</option>
              <option value="CSE">CSE</option>
              <option value="EEE">EEE</option>
              <option value="ME">ME</option>
              <option value="IEM">IEM</option>
              <option value="CE">CE</option>
              <option value="ECE">ECE</option>
              <option value="AIML">AIML</option>
            </select>
          </div>

          <!-- Designation -->
          <div class="mb-3">
            <label for="designation" class="form-label">Designation *</label>
            <select class="form-select" id="designation" required>
              <option value="" selected disabled>Select designation</option>
              <option value="HOD">Head of Department</option>
              <option value="Professor">Professor</option>
              <option value="Assistant Professor">Assistant Professor</option>
              <option value="Associate Professor">Associate Professor</option>
              <option value="Lab Incharge">Lab Incharge</option>
            </select>
          </div>

          <!-- Password -->
          <div class="mb-3">
            <label for="profPassword" class="form-label">Password *</label>
            <input type="password" class="form-control" id="profPassword" placeholder="Create a password" required />
          </div>
          
          <div id="message-box" class="alert" role="alert"></div>

          <button type="submit" class="btn btn-primary">Sign Up</button>
        </fieldset>
      </form>
    </div>

    <footer class="footer">
      <p>&copy; 2025 Academix</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- CORRECTED SCRIPT: Redirects to login.html -->
    <script>
let API_URL;

// Check if the hostname is 'localhost' or '127.0.0.1' (for local development)
if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
  // We are on the local machine, so use the local backend URL
  API_URL = 'http://localhost:3000/api';
} else {
  // We are on the live deployed site, so use the live Render URL
  API_URL = 'https://academix-backend-p6o4.onrender.com/api'; // <-- Make sure this is your actual Render URL
}
        const signupForm = document.getElementById('signup-form');
        const messageBox = document.getElementById('message-box');

        signupForm.addEventListener('submit', async (event) => {
            event.preventDefault();

            messageBox.style.display = 'none';
            messageBox.textContent = '';
            messageBox.classList.remove('alert-danger', 'alert-success');

            const formData = {
                fullName: document.getElementById('profName').value,
                email: document.getElementById('profEmail').value,
                password: document.getElementById('profPassword').value,
                department: document.getElementById('deptSelect').value,
                designation: document.getElementById('designation').value,
                employeeId: document.getElementById('employeeID').value
            };

            try {
                // Send the sign-up data to the backend
                const signupResponse = await fetch(`${API_URL}/signup`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(formData)
                });
                
                const signupResult = await signupResponse.json();

                if (!signupResponse.ok) {
                    // If sign-up fails (e.g., email exists), show the error and stop.
                    throw new Error(signupResult.error || 'An unexpected error occurred during sign-up.');
                }
                
                // On success, show a success message.
                messageBox.classList.add('alert-success');
                messageBox.textContent = 'Sign-up successful! Redirecting to login page...';
                messageBox.style.display = 'block';

                // After 2 seconds, redirect the user to the login page.
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 2000);

            } catch (error) {
                // Handle any error from the sign-up process.
                console.error('Sign-up failed:', error);
                messageBox.classList.remove('alert-success');
                messageBox.classList.add('alert-danger');
                messageBox.textContent = error.message;
                messageBox.style.display = 'block';
            }
        });
    </script>
  </body>
</html>
